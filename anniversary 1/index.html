<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Anniversary üíñ</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Sarabun',sans-serif;
  background:linear-gradient(180deg,#ffe6ec,#fff);
  display:flex;
  justify-content:center;
  overflow-x:hidden;
}
#app{
  max-width:420px;
  width:100%;
  min-height:100vh;
  background:#fff;
  box-shadow:0 0 25px rgba(0,0,0,.1);
  overflow:visible;
}
.hidden{display:none}

/* ===== ANIMATION ===== */
@keyframes float{
  from{transform:translateY(0);opacity:1}
  to{transform:translateY(-100vh);opacity:0}
}

/* ===== HEART ===== */
.heart{
  position:fixed;
  bottom:-20px;
  animation:float 4s linear;
  pointer-events:none;
  z-index:999999;
}

/* ===== LOCK PAGE ===== */
#lock{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
}
.lock-box{
  background:#fff5f8;
  padding:34px 22px 30px;
  border-radius:32px;
  box-shadow:0 15px 40px rgba(255,120,160,.35);
}
.lock-img{
  width:140px;height:140px;
  border-radius:50%;
  object-fit:cover;
  border:6px solid white;
}
.pin{
  font-size:30px;
  letter-spacing:14px;
  margin:18px 0 6px;
  color:#d81b60;
  min-height:34px;
}
.pin-hint{
  font-size:13px;
  color:#b85c75;
  margin-bottom:22px;
}
.keypad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
}
.key{
  width:60px;height:60px;
  border-radius:50%;
  border:none;
  background:#ffe6ec;
  font-size:20px;
}
.key.del{
  background:#ffd1dc;
  font-size:22px;
}

/* ===== LETTER ===== */
#letter{text-align:center;padding:40px 20px}
.btn{
  margin-top:20px;padding:14px 30px;
  border:none;border-radius:30px;
  background:#ff85a2;color:white;
  font-size:16px;
}

/* ===== PUZZLE ===== */
#puzzle{text-align:center;padding:20px}
.grid{
  width:300px;height:300px;margin:20px auto;
  display:grid;grid-template-columns:repeat(3,1fr);gap:2px;
}
.piece{background-size:300px 300px;cursor:pointer}

/* ===== QUIZ ===== */
#quiz{padding:20px;text-align:center}
.option{
  background:#ffe6ec;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  cursor:pointer;
}
.option.active{
  background:#ff85a2;
  color:#fff;
}

/* ===== CONTENT ===== */
#content{padding:20px}

.note{
  background:#fff5f8;
  border:2px dashed #ff85a2;
  border-radius:18px;
  padding:22px;
  white-space:pre-wrap;
  line-height:1.8;
}

.note h3{
  margin-top:0;
  margin-bottom:8px;
}

.note p{
  margin-top:0;
}

.card{
  margin-top:25px;
  background:linear-gradient(45deg,#ff85a2,#ffb3c6);
  border-radius:20px;padding:22px;
  color:white;text-align:center;
}
.timer{
  display:flex;justify-content:space-between;margin-top:15px;
}
.time-box{
  background:white;color:#d81b60;
  border-radius:12px;width:65px;
  padding:10px 5px;font-size:12px;
}
.time-box span{display:block;font-size:18px;font-weight:bold}
video{
  width:100%;margin-top:15px;border-radius:15px;
}

/* ‚ù§Ô∏èüéÜ HEART FIREWORK */
.firework-heart{
  position:fixed;
  bottom:-30px;
  font-size:22px;
  pointer-events:none;
  z-index:999998;
  animation:heartFirework ease-out forwards;
}
@keyframes heartFirework{
  0%{transform:translateY(0) scale(.6);opacity:1}
  70%{opacity:1}
  100%{transform:translateY(-90vh) scale(2.2);opacity:0}
}

/* üéµ MUSIC BUTTON */
.music-btn{
  position:fixed;
  top:16px;
  right:16px;
  width:46px;
  height:46px;
  border-radius:50%;
  border:none;
  background:linear-gradient(135deg,#ff85a2,#ffb3c6);
  color:#fff;
  font-size:20px;
  cursor:pointer;
  box-shadow:0 10px 25px rgba(255,120,160,.45);
  z-index:999999;
}
.music-btn.muted{
  background:#ffd1dc;
  color:#d81b60;
}

/* üéÜ NEW YEAR FIREWORK */
.firework{
  position:fixed;
  width:6px;
  height:6px;
  border-radius:50%;
  background:transparent;
  pointer-events:none;
  z-index:999997;
}
.firework::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  width:6px;
  height:6px;
  border-radius:50%;
  box-shadow:
    0 -20px #ff4d6d,
    14px -14px #ffd166,
    20px 0 #4d96ff,
    14px 14px #c77dff,
    0 20px #ff85a2,
    -14px 14px #ffd166,
    -20px 0 #4d96ff,
    -14px -14px #c77dff;
  animation:explode 1.2s ease-out forwards;
}
@keyframes explode{
  0%{transform:scale(0);opacity:1}
  100%{transform:scale(1.6);opacity:0}
}
</style>
</head>

<body>
<div id="app">

<!-- LOCK -->
<div id="lock">
  <div class="lock-box">
    <img src="img/lock.jpeg" class="lock-img">
    <h3>‡πÉ‡∏™‡πà‡∏£‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö üíñ</h3>
    ‡πÉ‡∏™‡πà‡πÉ‡∏´‡∏±‡∏ñ‡∏π‡∏Å‡∏ô‡∏∞‡∏≠‡πâ‡∏ß‡∏ô‡πÜ
    <div class="pin" id="pin"></div>
    <div class="pin-hint">‡∏ß‡∏±‡∏ô / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏õ‡∏µ (DDMMYY)</div>
    <div class="keypad" id="pad">
      <button class="key">1</button><button class="key">2</button><button class="key">3</button>
      <button class="key">4</button><button class="key">5</button><button class="key">6</button>
      <button class="key">7</button><button class="key">8</button><button class="key">9</button>
      <button class="key del">‚å´</button>
      <button class="key">0</button>
    </div>
  </div>
</div>

<!-- LETTER -->
<div id="letter" class="hidden">
  <h2>‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏´‡∏°‡∏•‡πà‡∏∞<br>‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡πâ‡∏ä‡∏ô‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ ‡∏≠‡∏¥‡∏≠‡∏¥ üíå</h2>
  <button class="btn" id="toPuzzle">‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</button>
</div>

<!-- PUZZLE -->
<div id="puzzle" class="hidden">
  <h2>‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡πà‡∏∞ üß©</h2>
  <div class="grid" id="grid"></div>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">
  <div class="question" data-answer="0">
    <h3>1. ‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£</h3>
    <div class="option">‡∏ö‡∏µ‡∏Å‡πâ‡∏≤</div>
    <div class="option">‡∏ä‡∏π‡∏Å‡πâ‡∏≤</div>
  </div>
  <div class="question" data-answer="0">
    <h3>2. ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∞‡πÑ‡∏£</h3>
    <div class="option">Oppa Daek</div>
    <div class="option">Swensen's</div>
  </div>
  <div class="question" data-answer="4">
    <h3>3. ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ü‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏≠‡∏∞‡πÑ‡∏£</h3>
    <div class="option">‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
    <div class="option">‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div>
    <div class="option">‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò</div>
    <div class="option">‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå</div>
    <div class="option">‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
  </div>
  <button class="btn" id="submitQuiz">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
</div>

<!-- VIDEO -->
<div id="videoScreen" class="hidden">
  <video id="memoryVideo" src="img/video/memory3.mp4" playsinline></video>
</div>

<!-- CONTENT -->
<div id="content" class="hidden">
  <div class="note">
    <h3>‡∏ñ‡∏∂‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤ ‚ù§Ô∏è</h3>
    <p id="loveText">
‡∏ú‡∏•‡∏≠‡πÅ‡∏õ‡πä‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏ô‡∏≠‡∏∞‡∏≠‡πâ‡∏ß‡∏ô
‡πÄ‡∏£‡∏≤‡∏™‡∏≠‡∏á‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö 1 ‡∏õ‡∏µ‡∏Å‡∏±‡∏ö‡∏≠‡∏µ‡∏Å 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏ï‡πá‡∏° ‡πÅ‡∏•‡πâ‡∏ß
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏≠‡πâ‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á ‡πÜ ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ó‡πâ‡∏≠ ‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß
‡∏≠‡πâ‡∏ß‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏õ‡πÑ‡∏´‡∏ô‡πÄ‡∏•‡∏¢ ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏≠‡πâ‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡πÜ

‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏≠‡πâ‡∏ß‡∏ô
‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏û‡∏π‡∏î‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î ‡∏á‡∏µ‡πà‡πÄ‡∏á‡πà‡∏≤ ‡πÄ‡∏≠‡∏≤‡πÅ‡∏ï‡πà‡πÉ‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏≠‡πâ‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏ß‡∏ô‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à ‡∏¢‡∏±‡∏á‡∏≠‡∏î‡∏ó‡∏ô
‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∞‡∏£‡∏±‡∏Å‡πÄ‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ

Happy New Year ‡∏ô‡∏∞‡∏≠‡πâ‡∏ß‡∏ô üéÜ
‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏≠‡πâ‡∏ß‡∏ô‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç
‡∏¢‡∏¥‡πâ‡∏°‡πÑ‡∏î‡πâ‡∏ö‡πà‡∏≠‡∏¢ ‡πÜ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏™‡∏ö‡∏≤‡∏¢ ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á
‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏µ ‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡πâ‡∏ß‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ

‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏µ‡πâ
‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ï‡∏•‡∏≠‡∏î‡πÜ
‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô
‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á ‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡πÜ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô ‡πÜ

‡∏ñ‡∏∂‡∏á‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤
‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ñ‡∏≤‡∏ó‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏Ç‡πâ‡∏≤‡∏á ‡πÜ ‡∏Å‡∏±‡∏ô
‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏î‡∏π‡∏û‡∏•‡∏∏‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏π‡πà‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏Å‡∏≠‡πâ‡∏ß‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏∞
‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á‡πÄ‡∏•‡∏¢‡πÅ‡∏°‡πâ‡πÅ‡∏ï‡πà‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏•‡∏¢
</p>

    </p>
  </div>

  <div class="card">
    <h2>‡πÄ‡∏£‡∏≤‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß</h2>
    <div class="timer">
      <div class="time-box"><span id="d">0</span>‡∏ß‡∏±‡∏ô</div>
      <div class="time-box"><span id="h">0</span>‡∏ä‡∏°.</div>
      <div class="time-box"><span id="m">0</span>‡∏ô‡∏≤‡∏ó‡∏µ</div>
      <div class="time-box"><span id="s">0</span>‡∏ß‡∏¥</div>
    </div>
    <video src="img/video/memory1.mp4" autoplay muted loop playsinline></video>
    <video src="img/video/memory2.mp4" autoplay muted loop playsinline></video>
  </div>
</div>

<audio id="bgm" src="img/music/bgm.mp3" loop></audio>
</div>

<button id="musicToggle" class="music-btn">üéµ</button>

<script>
setInterval(()=>{
  const h=document.createElement("div");
  h.className="heart";
  h.innerText="‚ù§Ô∏è";
  h.style.left=(Math.random()*100)+"vw";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),4000);
},700);

const PIN="301124";
const START="2024-11-30";
const PUZZLE_IMAGE="img/puzzle.jpeg";

const lock=document.getElementById("lock");
const letter=document.getElementById("letter");
const puzzle=document.getElementById("puzzle");
const quiz=document.getElementById("quiz");
const content=document.getElementById("content");
const pinEl=document.getElementById("pin");
const pad=document.getElementById("pad");
const grid=document.getElementById("grid");
const bgm=document.getElementById("bgm");
const videoPage=document.getElementById("videoScreen");
const memoryVideo=document.getElementById("memoryVideo");

const d=document.getElementById("d");
const h=document.getElementById("h");
const m=document.getElementById("m");
const s=document.getElementById("s");

function typeByWord(el,speed){
  const text=el.innerText.trim();
  const words=text.split(/\s+/);
  el.innerText="";
  let i=0;
  const timer=setInterval(()=>{
    el.innerText+=words[i]+" ";
    i++;
    if(i>=words.length){clearInterval(timer);}
  },speed);
}

let input="";
pad.onclick=e=>{
  if(!e.target.classList.contains("key"))return;
  if(e.target.classList.contains("del")){
    input=input.slice(0,-1);
    pinEl.innerText="*".repeat(input.length);
    return;
  }
  input+=e.target.innerText;
  pinEl.innerText="*".repeat(input.length);
  if(input.length===6){
    if(input===PIN){
      lock.style.display="none";
      letter.style.display="block";
    }else{
      input="";
      pinEl.innerText="";
    }
  }
};

document.getElementById("toPuzzle").onclick=()=>{
  letter.style.display="none";
  puzzle.style.display="block";
  initPuzzle();
};

let selected=null;
function initPuzzle(){
  grid.innerHTML="";
  [...Array(9).keys()].sort(()=>Math.random()-0.5).forEach(i=>{
    const d=document.createElement("div");
    d.className="piece";
    d.dataset.i=i;
    d.style.backgroundImage=`url(${PUZZLE_IMAGE})`;
    d.style.backgroundPosition=`${-(i%3)*100}px ${-Math.floor(i/3)*100}px`;
    d.onclick=()=>selectPiece(d);
    grid.appendChild(d);
  });
}
function selectPiece(el){
  if(!selected){selected=el;return;}
  [el.style.backgroundPosition,selected.style.backgroundPosition]=
  [selected.style.backgroundPosition,el.style.backgroundPosition];
  [el.dataset.i,selected.dataset.i]=
  [selected.dataset.i,el.dataset.i];
  selected=null;
  checkPuzzle();
}
function checkPuzzle(){
  const ok=[...document.querySelectorAll(".piece")]
    .every((p,i)=>Number(p.dataset.i)===i);
  if(ok){
    puzzle.style.display="none";
    quiz.classList.remove("hidden");
  }
}

document.querySelectorAll("#quiz .option").forEach(option=>{
  option.onclick=()=>{
    const q=option.parentElement;
    q.querySelectorAll(".option").forEach(o=>o.classList.remove("active"));
    option.classList.add("active");
  };
});

document.getElementById("submitQuiz").onclick=()=>{
  let pass=true;
  document.querySelectorAll("#quiz .question").forEach(q=>{
    const correct=Number(q.dataset.answer);
    const selected=[...q.querySelectorAll(".option")]
      .findIndex(o=>o.classList.contains("active"));
    if(selected!==correct) pass=false;
  });
  if(pass){
    quiz.classList.add("hidden");
    videoPage.classList.remove("hidden");
    memoryVideo.play();
  }
};

function launchFirework(){
  const f=document.createElement("div");
  f.className="firework";
  f.style.left=Math.random()*100+"vw";
  f.style.top=Math.random()*60+"vh";
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),1200);
}

let heartFireworkTimer=null;
function launchHeartFirework(){
  const heartEl=document.createElement("div");
  heartEl.className="firework-heart";
  heartEl.innerText=Math.random()>0.5?"‚ù§Ô∏è":"üíñ";
  heartEl.style.left=Math.random()*100+"vw";
  document.body.appendChild(heartEl);
  setTimeout(()=>heartEl.remove(),4500);
}

memoryVideo.onended=()=>{
  videoPage.classList.add("hidden");
  content.classList.remove("hidden");
  bgm.play();
  heartFireworkTimer=setInterval(launchHeartFirework,600);
  setInterval(launchFirework,900);
  typeByWord(document.getElementById("loveText"),300);
  const start=new Date(START).getTime();
  setInterval(()=>{
    let diff=Date.now()-start;
    d.innerText=Math.floor(diff/86400000);
    diff%=86400000;
    h.innerText=Math.floor(diff/3600000);
    diff%=3600000;
    m.innerText=Math.floor(diff/60000);
    s.innerText=Math.floor((diff%60000)/1000);
  },1000);
};

const musicBtn=document.getElementById("musicToggle");
musicBtn.onclick=()=>{
  if(bgm.paused){
    bgm.play();
    musicBtn.textContent="üéµ";
    musicBtn.classList.remove("muted");
  }else{
    bgm.pause();
    musicBtn.textContent="üîá";
    musicBtn.classList.add("muted");
  }
};
</script>
</body>
</html>
